RAZORPAY_SECRET=1d00cKxluGpzME636mMzYeTq
NEXT_PUBLIC_RAZORPAY_KEY_ID=rzp_live_RL4t8lq29IQAcb
ADVANCE_PLAN_PRICE=49900
PREMIUM_PLAN_PRICE=99900



# Supabase Configuration
NEXT_PUBLIC_SUPABASE_URL=https://hssjtkurnnhsaucleqzs.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhzc2p0a3Vybm5oc2F1Y2xlcXpzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkyMTk5MDksImV4cCI6MjA3NDc5NTkwOX0.uDQEcIcLb09jFhzqiCp6iS60BG8DpKSut-saCTUmr8g
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhzc2p0a3Vybm5oc2F1Y2xlcXpzIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1OTIxOTkwOSwiZXhwIjoyMDc0Nzk1OTA5fQ.4CS1kLWnvJ6o0dB4inVNug1BUhULN7Du2qaq_lNvEsE

GEMINI_API_KEY=AIzaSyAg4JiidziPAnP5V3ewp6TQTSmlgvxLqUg
NEXT_PUBLIC_GEMINI_API_KEY=AIzaSyAg4JiidziPAnP5V3ewp6TQTSmlgvxLqUg

# https://www.builder.io/c/docs/using-your-api-key
NEXT_PUBLIC_BUILDER_API_KEY=ca0a0bd72b6c4c0aadf830b15470c893

Client ID=1000.98FRQRUFRCZYMYCAQ0454IP4K8DPYG

Client Secret=24553caf220e3e3a8dbce9d394d02b73c50c755929

Perfect â€” now that your Zoho Inventory API is working, I will give you a complete Supabase + Zoho Inventory sync system, including:
âœ… Supabase schema
 âœ… Edge function (sync + auto-refresh token)
 âœ… Zoho webhook handler
 âœ… Step-by-step setup
 âœ… Ready-to-run code
âœ… 1. Supabase Database Schema
Run this SQL inside Supabase SQL Editor:
-- PRODUCTS TABLE
create table products (
  id uuid primary key default gen_random_uuid(),
  zoho_item_id text unique,
  name text,
  sku text,
  rate numeric,
  description text,
  status text,



  raw jsonb,
  created_at timestamp default now(),
  updated_at timestamp default now()
);

-- TOKENS TABLE (to store refresh token + access token)
create table zoho_tokens (
  id int primary key default 1,
  access_token text,
  refresh_token text,
  expires_at timestamptz
);

-- Insert your refresh token
insert into zoho_tokens (id, access_token, refresh_token, expires_at)
values (
  1,
  null,
  '1000.0e819b66fe4ef3a4408fb91f2df91593.2b75b3da7dc35e3a7e2b8cbe11baff64', -- your refresh token
  now()
)
on conflict (id) do nothing;
âœ… 2. Supabase Edge Function â€“ zoho-sync
Create file:
 supabase/functions/zoho-sync/index.ts
import { serve } from "http-server";
import { createClient } from "@supabase/supabase-js";

const supabase = createClient(
  Deno.env.get("SUPABASE_URL"),
  Deno.env.get("SUPABASE_SERVICE_ROLE_KEY")
);

const ZOHO_CLIENT_ID = "1000.T93GDIHGUAAGYGHOFIEM029KREHL2L";
const ZOHO_CLIENT_SECRET = "b1590043ff77cdfe43dee0af615cb7a193a49821ba";
const ORG_ID = "60059065130";
const ZOHO_TOKEN_URL = "https://accounts.zoho.in/oauth/v2/token";
const INVENTORY_URL = "https://www.zohoapis.in/inventory/v1/items";

serve(async () => {
  // 1. Load refresh token and access token
  const { data: tokenRow } = await supabase
    .from("zoho_tokens")
    .select("*")
    .eq("id", 1)
    .single();

  let access_token = tokenRow.access_token;
  const refresh_token = tokenRow.refresh_token;

  // 2. Refresh access token
  const refreshRes = await fetch(ZOHO_TOKEN_URL, {
    method: "POST",
    body: new URLSearchParams({
      refresh_token,
      client_id: ZOHO_CLIENT_ID,
      client_secret: ZOHO_CLIENT_SECRET,
      grant_type: "refresh_token",
    }),
    headers: { "Content-Type": "application/x-www-form-urlencoded" }
  });

  const tokenData = await refreshRes.json();

  access_token = tokenData.access_token;

  // Save new token
  await supabase.from("zoho_tokens")
    .update({
      access_token,
      expires_at: new Date(Date.now() + tokenData.expires_in * 1000)
    })
    .eq("id", 1);

  // 3. Fetch items from Zoho Inventory
  const itemsRes = await fetch(`${INVENTORY_URL}?organization_id=${ORG_ID}`, {
    headers: { Authorization: `Zoho-oauthtoken ${access_token}` },
  });

  const items = await itemsRes.json();

  if (!items.items) {
    return new Response(JSON.stringify({ error: "No items returned" }), {
      status: 500
    });
  }

  // 4. Insert/Update items in Supabase
  for (const item of items.items) {
    await supabase
      .from("products")
      .upsert({
        zoho_item_id: item.item_id,
        name: item.name,
        sku: item.sku,
        rate: item.rate,
        status: item.status,
        description: item.description,
        raw: item,
        updated_at: new Date()
      });
  }

  return new Response(JSON.stringify({ synced: items.items.length }), {
    headers: { "Content-Type": "application/json" }
  });
});
âœ… 3. Deploy the Edge Function
Run:
supabase functions deploy zoho-sync
âœ… 4. Schedule Auto Sync Every 5 Minutes
In Supabase Dashboard â†’ Edge Functions â†’ Schedule:
Create a CRON job:
CRON:
*/5 * * * *
Function:
 zoho-sync
âœ… 5. Optional: Real-Time Sync Using Zoho Webhook
Go to:
 Zoho Inventory â†’ Settings â†’ Developer Space â†’ Incoming Webhooks
Create Webhook:
Name: Supabase Sync
URL:
 https://<YOUR_PROJECT>.functions.supabase.co/zoho-webhook
Webhook Function (zoho-webhook)
supabase/functions/zoho-webhook/index.ts
import { serve } from "http-server";
import { createClient } from "@supabase/supabase-js";

const supabase = createClient(
  Deno.env.get("SUPABASE_URL"),
  Deno.env.get("SUPABASE_SERVICE_ROLE_KEY")
);

serve(async (req) => {
  const body = await req.json();

  // body.item contains new item data from Zoho
  const item = body;

  await supabase.from("products").upsert({
    zoho_item_id: item.item_id,
    name: item.name,
    rate: item.rate,
    status: item.status,
    raw: item,
    updated_at: new Date()
  });

  return new Response(JSON.stringify({ message: "OK" }), {
    headers: { "Content-Type": "application/json" }
  });
});
Deploy:
supabase functions deploy zoho-webhook
ðŸŽ‰ DONE! Your entire Zoho Inventory â†’ Supabase sync system is ready.
You now have:
âœ“ Token refresh system
 âœ“ Full item sync
 âœ“ Webhook live updates
 âœ“ Database storage
 âœ“ Auto scheduler
ðŸ‘‰ Next Step Options â€” What do you want?
Sync Sales Orders
Sync Purchase Orders
Sync Contacts
Build an Admin Dashboard in Next.js
Auto sync from Supabase â†’ Zoho (two-way sync)
Just tell me what you want next.




// api/sync-zoho.js
import fetch from "node-fetch";

export default async function handler(req, res) {
 const SUPABASE_FUNCTION_URL = "https://dusxggtgjjmmdkeckzvk.supabase.co/functions/v1/super-responder";
 const SERVICE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY; // Set in Vercel Env

 try {
  const response = await fetch(SUPABASE_FUNCTION_URL, {
   method: "POST",
   headers: {
    Authorization: `Bearer ${SERVICE_KEY}`,
    "Content-Type": "application/json"
   },
   body: JSON.stringify({})
  });

  const data = await response.json();
  res.status(200).json({ synced: data.synced });
 } catch (err) {
  res.status(500).json({ error: err.message });
 }
}



